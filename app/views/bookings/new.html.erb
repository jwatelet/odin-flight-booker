<h1>New Booking</h1>

<% unless @booking.errors.empty? %>
  <div class="errors">
    <ul>
      <% @booking.errors.full_messages.each do |message| %>
      <li>
        <%= message %>
      </li>
      <% end %>
    </ul>  
  </div>
<% end %>

<%= turbo_frame_tag "new_booking" do %>
  <div class="form">
    <%= form_for(@booking) do |f| %>
      <%= f.hidden_field :flight_id, value: @booking.flight_id %>
    
      <div class="passengers">
        <ul>
          <%= f.fields_for(:passengers) do |f_passenger| %>
            <li class="passenger" >
              <h4>Passenger #<%= f_passenger.index + 1 %></h4>
              <div class="field">
                <%= f_passenger.label :firstname %>
                <%= f_passenger.text_field :firstname %>
              </div>
              <div class="field">
                <%= f_passenger.label :lastname %>
                <%= f_passenger.text_field :lastname %>
              </div>
              <div class="field">
                <%= f_passenger.label :email %>
                <%= f_passenger.email_field :email %>
              </div>
              <div class="field">

                <%= link_to new_booking_path(flight_id: @booking.flight_id, 
                                passengers: @booking.passengers.length-1), class: "remove" do %>
                  <%= image_tag 'account-remove.svg' %>
                <% end %>
              </div>
            </li>
          <% end %>
        </ul>
      </div>
      <div class="actions">
        <%= f.submit class: "submit"%>
        <%= link_to new_booking_path(flight_id: @booking.flight_id, 
                                    passengers: @booking.passengers.length+1), class: "add" do %>
          <%= image_tag 'account-plus.svg' %>
        <% end %>
      </div>
    <% end %>
  </div>
<% end %>